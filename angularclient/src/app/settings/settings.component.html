<form [formGroup]="settingsForm" (ngSubmit)="onSubmit()" class="settings-form">
  <div fxLayout="column" fxLayoutGap="1rem" fxFlex.gt-md="75%">
    <div class="mat-display-1">
      <span class="logo">ampd</span> settings
    </div>
    <mat-divider></mat-divider>
    <span class="mat-headline">Appearance</span>
    <!-- Dark mode toggle -->
    <mat-card>
      <mat-card-header>
        <mat-card-title>Dark theme</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-slide-toggle
            class="space-right"
            [checked]="isDarkTheme | async"
            (change)="toggleDarkTheme($event.checked)"
            title="Turn the lights off / on"
        >ðŸ’¡
          <mat-hint align="end"
          >Toggle the theme from bright to dark and back.
          </mat-hint
          >
        </mat-slide-toggle>
      </mat-card-content>
    </mat-card>
    <!-- Toggle cover display -->
    <mat-card>
      <mat-card-header>
        <mat-card-title>Display covers</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-slide-toggle
            class="space-right"
            [checked]="isDisplayCovers"
            (change)="toggleDisplayCovers($event.checked)"
        >ðŸ’¡
          <mat-hint align="end"
          >Toggle if covers should be displayed in the queue.
          </mat-hint
          >
        </mat-slide-toggle>
      </mat-card-content>
    </mat-card>
    <!-- Toggle display 'Save playlist' button -->
    <mat-card>
      <mat-card-header>
        <mat-card-title>Display &quot;Save playlist&quot; button</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-slide-toggle
            class="space-right"
            [checked]="isDisplaySavePlaylist"
            (change)="toggleDisplaySavePlaylist($event.checked)"
        >ðŸ’¡
          <mat-hint align="end"
          >Toggle the button &quot;Save playlist&quot; should be display in the queue.
          </mat-hint
          >
        </mat-slide-toggle>
      </mat-card-content>
    </mat-card>
    <mat-divider></mat-divider>
    <span class="mat-headline">Backend settings</span>
    <div class="mat-caption">These settings have to be changed via
      <span class="mono code">-D</span> when starting ampd. Alternatively, write them to
      an <span class="mono code">ampd.conf</span> file. See the
      <a class="no-deco-links" href="https://github.com/rain0r/ampd/blob/master/README.md">README</a> for more.</div>
    <!-- Backend  -->
    <mat-card>
      <mat-form-field class="full-width">
        <input
            matInput
            required
            formControlName="backendAddr"
            placeholder="http://your-computer:8080"
        />
        <mat-hint align="end"
        >Use the name or IP of the computer running ampd.
        </mat-hint
        >
      </mat-form-field>
    </mat-card>
    <!-- Cover cache -->
    <mat-card *ngIf="backendSettings | async as settings">
      <mat-card-header>
        <mat-card-title>Cover cache</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-slide-toggle
            class="space-right"
            [checked]="settings.localCoverCache"
            disabled
        >
          <mat-hint align="end"
          >Saves covers locally.
          </mat-hint
          >
        </mat-slide-toggle>
      </mat-card-content>
      <mat-card-footer class="card-footer">
        Configure with <span class="mono code">-Dlocal.cover.cache=true</span> when starting ampd.
      </mat-card-footer>
    </mat-card>
    <!-- MusicBrainz cover service -->
    <mat-card *ngIf="backendSettings | async as settings">
      <mat-card-header>
        <mat-card-title>MusicBrainz</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-slide-toggle
            class="space-right"
            [checked]="settings.mbCoverService"
            disabled
        >
          <mat-hint align="end"
          >Get covers from MusicBrainz.
            <span *ngIf="coverCacheUsage | async as usage">
              <span *ngIf="usage > 0">
              Currently {{ usage | filesize }} used.
                </span>
            </span>
          </mat-hint
          >
        </mat-slide-toggle>
      </mat-card-content>
      <mat-card-footer class="card-footer">
        Configure with <span class="mono code">-Dmb.cover.service=true</span> when starting ampd.
      </mat-card-footer>
    </mat-card>
    <!-- Cover blacklist -->
    <mat-card *ngIf="backendSettings | async as settings">
      <mat-card-header>
        <mat-card-title>Cover blacklist</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-list role="list" *ngIf="settings.mbCoverService && coverBlacklist | async as blacklist">
          <mat-list-item *ngFor="let song of blacklist" class="smaller-font">
            {{song}}
          </mat-list-item>
        </mat-list>
      </mat-card-content>
      <mat-card-footer class="card-footer">
        These files will not download a cover from MusicBrainz.
      </mat-card-footer>
    </mat-card>
    <!-- Music directory -->
    <mat-card *ngIf="backendSettings | async as settings">
      <mat-card-header>
        <mat-card-title>Music directory</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>{{settings.musicDirectory}}</mat-label>
          <input matInput disabled>
          <mat-hint>
            Corresponds to the value of <span class="mono">music_directory</span> in the mpd.conf.
          </mat-hint>
        </mat-form-field>
      </mat-card-content>
      <mat-card-footer class="card-footer">
        Configure with <span class="mono code">-Dmpd.music.directory</span> when starting ampd.
      </mat-card-footer>
    </mat-card>
    <!-- MPD Server -->
    <mat-card *ngIf="backendSettings | async as settings">
      <mat-card-header>
        <mat-card-title>MPD server</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>{{settings.mpdServer}}</mat-label>
          <input matInput disabled>
          <mat-hint>
            The name or ip of the computer that runs MPD.
          </mat-hint>
        </mat-form-field>
      </mat-card-content>
      <mat-card-footer class="card-footer">
        Configure with <span class="mono code">-Dmpd.server</span> when starting ampd.
      </mat-card-footer>
    </mat-card>
    <!-- MPD Server -->
    <mat-card *ngIf="backendSettings | async as settings">
      <mat-card-header>
        <mat-card-title>MPD port</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>{{settings.mpdPort}}</mat-label>
          <input matInput disabled>
          <mat-hint>
            The port on which MPD runs.
          </mat-hint>
        </mat-form-field>
      </mat-card-content>
      <mat-card-footer class="card-footer">
        Configure with <span class="mono code">-Dmpd.port=6600</span> when starting ampd.
      </mat-card-footer>
    </mat-card>
    <!-- Submit Button -->
    <div>
      <button
          mat-raised-button
          color="primary"
          type="submit"
          class="full-width themed-element"
      >
        Save
      </button>
    </div>

    <div class="mono">
      Version:
      <span class="logo" title="ampd version">{{ ampdVersion }}</span> &nbsp;
      <span
          *ngIf="gitCommitId !== 'live'"
          class="text-muted logo"
          title="git commit id"
      >{{ gitCommitId }}</span
      >
    </div>

    <div class="mono">
      Source code at:
      <a class="mat-app-background" href="https://github.com/rain0r/ampd"
      >github.com/rain0r/ampd</a
      >
    </div>
  </div>
</form>
